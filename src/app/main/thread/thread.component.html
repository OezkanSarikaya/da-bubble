<section class="thread" [ngClass]="{ 'ThreadOpen': isVisible, 'ThreadClosed': !isVisible }">
  <div class="threadName">
    <div>
      <h3>Thread</h3>
      <span># {{channelObserved()?.name}}</span>
    </div>


    <svg (click)="hide()" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <mask id="mask0_79092_694" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="24">
      <rect width="24" height="24" fill="#D9D9D9"/>
      </mask>
      <g mask="url(#mask0_79092_694)">
      <path d="M12 13.4L7.10005 18.3C6.91672 18.4833 6.68338 18.575 6.40005 18.575C6.11672 18.575 5.88338 18.4833 5.70005 18.3C5.51672 18.1167 5.42505 17.8833 5.42505 17.6C5.42505 17.3167 5.51672 17.0833 5.70005 16.9L10.6 12L5.70005 7.09999C5.51672 6.91665 5.42505 6.68332 5.42505 6.39999C5.42505 6.11665 5.51672 5.88332 5.70005 5.69999C5.88338 5.51665 6.11672 5.42499 6.40005 5.42499C6.68338 5.42499 6.91672 5.51665 7.10005 5.69999L12 10.6L16.9 5.69999C17.0834 5.51665 17.3167 5.42499 17.6 5.42499C17.8834 5.42499 18.1167 5.51665 18.3 5.69999C18.4834 5.88332 18.575 6.11665 18.575 6.39999C18.575 6.68332 18.4834 6.91665 18.3 7.09999L13.4 12L18.3 16.9C18.4834 17.0833 18.575 17.3167 18.575 17.6C18.575 17.8833 18.4834 18.1167 18.3 18.3C18.1167 18.4833 17.8834 18.575 17.6 18.575C17.3167 18.575 17.0834 18.4833 16.9 18.3L12 13.4Z" fill="black"/>
      </g>
      </svg>
  </div>

  <div class="threadBody">
      @if(threadObserved()?.senderID !== currentUser.idFirebase){
        <div class="chatMessage leftMessage">
          <img
            class="userProfile70"
            src="{{threadObserved()?.senderData?.avatar}}"
            alt=""
          />
          <div class="chatMessageDetails">
            <header>
              <span class="userName">{{threadObserved()?.senderData?.fullName}}</span>
              <time class="time" datetime="">{{threadObserved()?.time}}</time>
            </header>
            <div class="messageText">{{threadObserved()?.content}}</div>
          </div>
        </div> 
      }@else {
        <div class="chatMessage rightMessage">
          <img
            class="userProfile70"
            src="{{threadObserved()?.senderData?.avatar}}"
            alt=""
          />
          <div class="chatMessageDetails">
            <header>
              <span class="userName">{{threadObserved()?.senderData?.fullName}}</span>
              <time class="time" datetime="">{{threadObserved()?.time}}</time>
            </header>
            <div class="messageText">{{threadObserved()?.content}}</div>
          </div>
        </div> 
      }

      <div class="countThread">
        <span> {{threadObserved()?.threadIDS?.length}} Antworten</span>
        <div class="horizontal-line"></div>
      </div>

      @if(threadObserved()?.senderID){
        @for (thread of threadObserved()?.threadData; track $index) {
          @if(thread.senderID !== currentUser.idFirebase){
            @if(currentDate === thread.createAtString){
              <div class="timeLine"><span>Heute</span></div>
            }@else{
              <div class="timeLine"><span>{{thread.createAtString}}</span></div>
            }
            <div class="chatMessage leftMessage">
              <img
                class="userProfile70"
                src="{{thread.senderData?.avatar}}"
                alt=""
              />
              <div class="chatMessageDetails">
                <header>
                  <span class="userName">{{thread.senderData?.fullName}}</span>
                  <time class="time" datetime="">{{thread.time}}</time>
                </header>
                <div class="messageText">{{thread.content}}</div>
              </div>
            </div> 
          }@else {
            @if(currentDate === thread.createAtString){
              <div class="timeLine"><span>Heute</span></div>
            }@else{
              <div class="timeLine"><span>{{thread.createAtString}}</span></div>
            }
            <div class="chatMessage rightMessage">
              <div class="addReaction rightPopup">              
                <span class="editDeleteMsg">
                  <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <mask id="mask0_79092_16838" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="25" height="24">
                    <rect x="0.333252" width="24" height="24" fill="#D9D9D9"/>
                    </mask>
                    <g mask="url(#mask0_79092_16838)">
                    <path d="M12.3333 20C11.7833 20 11.3124 19.8042 10.9208 19.4125C10.5291 19.0208 10.3333 18.55 10.3333 18C10.3333 17.45 10.5291 16.9792 10.9208 16.5875C11.3124 16.1958 11.7833 16 12.3333 16C12.8833 16 13.3541 16.1958 13.7458 16.5875C14.1374 16.9792 14.3333 17.45 14.3333 18C14.3333 18.55 14.1374 19.0208 13.7458 19.4125C13.3541 19.8042 12.8833 20 12.3333 20ZM12.3333 14C11.7833 14 11.3124 13.8042 10.9208 13.4125C10.5291 13.0208 10.3333 12.55 10.3333 12C10.3333 11.45 10.5291 10.9792 10.9208 10.5875C11.3124 10.1958 11.7833 10 12.3333 10C12.8833 10 13.3541 10.1958 13.7458 10.5875C14.1374 10.9792 14.3333 11.45 14.3333 12C14.3333 12.55 14.1374 13.0208 13.7458 13.4125C13.3541 13.8042 12.8833 14 12.3333 14ZM12.3333 8C11.7833 8 11.3124 7.80417 10.9208 7.4125C10.5291 7.02083 10.3333 6.55 10.3333 6C10.3333 5.45 10.5291 4.97917 10.9208 4.5875C11.3124 4.19583 11.7833 4 12.3333 4C12.8833 4 13.3541 4.19583 13.7458 4.5875C14.1374 4.97917 14.3333 5.45 14.3333 6C14.3333 6.55 14.1374 7.02083 13.7458 7.4125C13.3541 7.80417 12.8833 8 12.3333 8Z" fill="#1C1B1F"/>
                    </g>
                    </svg>
                    <div class="msgText">
                      <p (click)="editMessageThread(thread.id)">Nachricht bearbeiten</p>
                      <p (click)="deleteMessage(thread.id, selectedThread()!.id)">LÃ¶schen</p>
                    </div>
                    
                </span>
              </div>
              <img
                class="userProfile70"
                src="{{thread.senderData?.avatar}}"
              />
              <div class="chatMessageDetails">
                <header>
                  <span class="userName">{{thread.senderData?.fullName}}</span>
                  <time class="time" datetime="">{{thread.time}}</time>
                </header>
                <div class="messageText">{{thread.content}}</div>
              </div>
            </div> 
          }
          
        }
      }
  </div>

  <app-chatmsgbox context="thread" [content]="contentThread" [nameChannel]="nameChannelSignal"></app-chatmsgbox>
</section>
